#!/bin/sh
## Kill Emacs-X11 and Cygwin/X, plus clean up Emacs temp files

# Kill relevant processes, using the Win32 API if necessary
# XXX: Must use Cygwin kill command instead of shell builtin
set -x
/usr/bin/kill -f `pgrep -i 'emacs|xinit|xwin|gam_server'`
{ set +x; } 2>/dev/null

# Determine Cygwin's temporary directory
{ test -d "$TMPDIR" && tmp=$TMPDIR ; } ||
{ test -d "$TEMP"   && tmp=$TEMP   ; } ||
{ test -d /tmp      && tmp=/tmp    ; } ||
{ echo >&2 "ERROR: cannot find temporary directory" ; exit 1 ; }

# Remove temporary directories and files generated by Emacs
set -x
cd "$tmp"
rm -rf emacs[1234567890]* docview[1234567890]* burl???????.html babel-?* \
       buffer-content-?* epg-output?* # emacs*.stackdump
